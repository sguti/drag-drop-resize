{"version":3,"file":"dragy.js.map","sources":["ng://dragy/lib/services/internal-registry.service.ts","ng://dragy/lib/models/draggable-directive.config.ts","ng://dragy/lib/directives/draggable.directive.ts","ng://dragy/lib/directives/droppable.directive.ts","ng://dragy/lib/services/component-registry.service.ts","ng://dragy/lib/services/component-factory.service.ts","ng://dragy/lib/models/drop-zone.state.ts","ng://dragy/lib/components/drop-zone/drop-zone.component.ts","ng://dragy/lib/dragy.module.ts","ng://dragy/lib/interfaces/IWidgetProjection.ts","ng://dragy/lib/models/drag-data.model.ts","ng://dragy/lib/models/drop-success-synthetic-event.ts","ng://dragy/lib/models/view-container-item.model.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\nimport { DraggableDirectiveConfig } from \"../models/draggable-directive.config\";\nimport { DragData } from \"../models/drag-data.model\";\nimport { ViewContainerItem } from \"../models/view-container-item.model\";\n\n@Injectable({\n  providedIn: \"root\"\n})\nexport class GInternalRegistryService {\n  constructor() {}\n  private widgetRegistry: { [key: string]: DraggableDirectiveConfig } = {};\n  private dragEventRegistry: { [key: string]: DragData } = {};\n  private viewContainerRegistry: {\n    [key: string]: ViewContainerItem;\n  } = {};\n  registerWidget(config: DraggableDirectiveConfig): boolean {\n    if (!config.widgetId || this.widgetRegistry[config.widgetId]) {\n      return false;\n    }\n    this.widgetRegistry[config.widgetId] = config;\n    return true;\n  }\n  unRegisterWidget(widgetId: string): boolean {\n    return delete this.widgetRegistry[widgetId];\n  }\n  getWidgetConfig(widgetId: string): DraggableDirectiveConfig {\n    return this.widgetRegistry[widgetId];\n  }\n  addDragData(dragId: string, dragData: DragData) {\n    this.dragEventRegistry[dragId] = dragData;\n  }\n  getDragData(dragId: string): DragData {\n    return this.dragEventRegistry[dragId];\n  }\n  clearDragData(dragId: string): boolean {\n    return delete this.dragEventRegistry[dragId];\n  }\n  addViewContainerItem(identifier: string, entry: ViewContainerItem) {\n    this.viewContainerRegistry[identifier] = entry;\n  }\n  getViewContainerItem(identifer: string): ViewContainerItem {\n    return this.viewContainerRegistry[identifer];\n  }\n  getAllViewContainerItem(): ViewContainerItem[] {\n    return Object.keys(this.viewContainerRegistry).map(\n      key => this.viewContainerRegistry[key]\n    );\n  }\n  removeViewContainerItem(identifer: string): boolean {\n    return delete this.viewContainerRegistry[identifer];\n  }\n  checkViewContainerItemEntry(identifer: string) {\n    return identifer in this.viewContainerRegistry;\n  }\n}\n","export class DraggableDirectiveConfig {\r\n  componentName: string;\r\n  widgetId: string;\r\n  dragImage: string;\r\n  componentHeight: number;\r\n  componentWidth: number;\r\n}\r\n","import {\n  Directive,\n  HostListener,\n  ElementRef,\n  Input,\n  OnInit,\n  OnDestroy\n} from \"@angular/core\";\nimport { GInternalRegistryService } from \"../services/internal-registry.service\";\nimport { DraggableDirectiveConfig } from \"../models/draggable-directive.config\";\nimport { DragData } from \"../models/drag-data.model\";\n\n@Directive({\n  selector: \"[gDraggable]\"\n})\nexport class DraggableDirective implements OnInit, OnDestroy {\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"gConfig\") config: DraggableDirectiveConfig;\n\n  private registered = false;\n  private offsetX: any;\n  private offsetY: any;\n  constructor(\n    private elementRef: ElementRef,\n    private internalRegistry: GInternalRegistryService\n  ) {}\n\n  ngOnInit(): void {\n    if (this.internalRegistry.registerWidget(this.config)) {\n      this.registered = true;\n      this.elementRef.nativeElement.setAttribute(\"draggable\", \"true\");\n    } else {\n      console.error(`Widget id ${this.config.widgetId} is not unique`);\n      this.showInvalidWidget();\n    }\n  }\n  ngOnDestroy(): void {\n    this.internalRegistry.unRegisterWidget(this.config.widgetId);\n  }\n  showInvalidWidget() {\n    const border = this.elementRef.nativeElement.style.border;\n    this.elementRef.nativeElement.style.border = \"2px solid red\";\n    setTimeout(() => {\n      this.elementRef.nativeElement.style.border = border;\n    }, 2000);\n  }\n  @HostListener(\"mousedown\", [\"$event\"])\n  mouseDownHandler(event: MouseEvent) {\n    if (this.registered) {\n      this.offsetX = event.offsetX;\n      this.offsetY = event.offsetY;\n      console.log(`x: ${this.offsetX},y : ${this.offsetY}`);\n    }\n  }\n  @HostListener(\"dragstart\", [\"$event\"])\n  dragStartHandler(event: DragEvent) {\n    if (this.registered) {\n      if (this.config.dragImage && false) {\n        const image = new Image(\n          this.config.componentWidth,\n          this.config.componentHeight\n        );\n        image.src = this.config.dragImage;\n        event.dataTransfer.setDragImage(image, 0, 0);\n      }\n      const eventId = \"drag_\" + Math.floor(Math.random() * 9999999) + 1;\n      this.internalRegistry.addDragData(eventId, {\n        offsetX: this.offsetX,\n        offsetY: this.offsetY,\n        widgetId: this.config.widgetId\n      });\n      event.dataTransfer.setData(eventId, eventId);\n    }\n  }\n  @HostListener(\"dragend\", [\"$event\"])\n  dragEndHandler(event: DragEvent) {}\n}\n","import {\n  Directive,\n  HostListener,\n  ElementRef,\n  Output,\n  EventEmitter,\n  OnInit,\n  Renderer2,\n  OnDestroy\n} from \"@angular/core\";\nimport { DropSuccessSyntheticEvent } from \"../models/drop-success-synthetic-event\";\nimport { GInternalRegistryService } from \"../services/internal-registry.service\";\nimport { DraggableDirectiveConfig } from \"../models/draggable-directive.config\";\nimport { DragData } from \"../models/drag-data.model\";\nimport { fromEvent, timer } from \"rxjs\";\nimport { debounce, takeWhile, distinctUntilChanged, tap } from \"rxjs/operators\";\n\n@Directive({\n  selector: \"[gDroppable]\"\n})\nexport class DroppableDirective implements OnInit, OnDestroy {\n  constructor(\n    private elementRef: ElementRef,\n    private renderer: Renderer2,\n    private internalRegistry: GInternalRegistryService\n  ) {}\n  private isAlive = true;\n  private _tempDropLocation: HTMLElement;\n  private validDropTarget = true;\n  private _current: {\n    eventId: string;\n    dragData: DragData;\n    config: DraggableDirectiveConfig;\n  };\n  @Output() dropsuccess = new EventEmitter<DropSuccessSyntheticEvent>();\n\n  ngOnInit(): void {\n    this._tempDropLocation = document.createElement(\"div\");\n    this._tempDropLocation.style.border = \"2px dashed green\";\n    this._tempDropLocation.style.position = \"absolute\";\n    fromEvent(this.elementRef.nativeElement, \"dragover\")\n      .pipe(\n        takeWhile(() => this.isAlive),\n        tap((event: DragEvent) => event.preventDefault()),\n        distinctUntilChanged((event1: DragEvent, event2: DragEvent) => {\n          return (\n            event1.clientX === event2.clientX &&\n            event1.clientY === event2.clientY\n          );\n        }),\n        debounce(() => timer(100))\n      )\n      .subscribe(this.dragOverHandler);\n  }\n  ngOnDestroy(): void {\n    this.isAlive = false;\n  }\n  @HostListener(\"dragenter\", [\"$event\"])\n  dragEnterHandler(event: DragEvent) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = \"move\";\n    const eventId = event.dataTransfer.types[0];\n    const dragData = this.internalRegistry.getDragData(eventId);\n    const config = this.internalRegistry.getWidgetConfig(dragData.widgetId);\n    this._current = {\n      eventId: event.dataTransfer.types[0],\n      dragData: this.internalRegistry.getDragData(eventId),\n      config: this.internalRegistry.getWidgetConfig(dragData.widgetId)\n    };\n    this._tempDropLocation.style.height = config.componentHeight + \"px\";\n    this._tempDropLocation.style.width = config.componentWidth + \"px\";\n    this.renderer.appendChild(\n      this.elementRef.nativeElement,\n      this._tempDropLocation\n    );\n  }\n  dragOverHandler = (event: DragEvent) => {\n    event.preventDefault();\n    console.log(event);\n    const react = (this.elementRef\n      .nativeElement as HTMLElement).getBoundingClientRect();\n\n    const dropItemStartX =\n      event.clientX - react.left - this._current.dragData.offsetX;\n    const dropItemEndX = dropItemStartX + this._current.config.componentWidth;\n    const dropItemStartY =\n      event.clientY - react.top - this._current.dragData.offsetY;\n    const dropItemEndY = dropItemStartY + this._current.config.componentHeight;\n    this.validDropTarget = !this.internalRegistry\n      .getAllViewContainerItem()\n      .some(registryItem => {\n        return (\n          registryItem.startX < dropItemEndX &&\n          registryItem.endX > dropItemStartX &&\n          registryItem.startY < dropItemEndY &&\n          registryItem.endY > dropItemStartY\n        );\n      });\n    this._tempDropLocation.style.top = dropItemStartY + \"px\";\n    this._tempDropLocation.style.left = dropItemStartX + \"px\";\n    // tslint:disable-next-line:semicolon\n    this._tempDropLocation.style.borderColor = this.validDropTarget\n      ? \"Green\"\n      : \"Red\";\n  };\n\n  @HostListener(\"dragleave\", [\"$event\"])\n  dragLeaveHandler(event: DragEvent) {\n    console.log(\"drag leave\");\n  }\n  @HostListener(\"drop\", [\"$event\"])\n  dropHandler(event: DragEvent) {\n    event.preventDefault();\n    if (this.validDropTarget) {\n      const dropSuccessEvent: DropSuccessSyntheticEvent = {\n        event: event,\n        componentName: this._current.config.componentName,\n        dragSourceSelector: this._current.config.widgetId,\n        widgetId: this._current.config.widgetId,\n        style: {\n          position: \"absolute\",\n          \"top.px\": this._tempDropLocation.style.top.replace(/px/, \"\"),\n          \"left.px\": this._tempDropLocation.style.left.replace(/px/, \"\")\n        }\n      };\n\n      this.dropsuccess.emit(dropSuccessEvent);\n    }\n    this.renderer.removeChild(\n      this.elementRef.nativeElement,\n      this._tempDropLocation\n    );\n  }\n}\n","import { Injectable, Type } from \"@angular/core\";\n\n@Injectable({\n  providedIn: \"root\"\n})\nexport class GComponentRegistryService {\n  private registry = new Set<Type<{}>>();\n  constructor() {}\n  register(\n    componentName: string,\n    component: Type<{}>\n  ): GComponentRegistryService {\n    if (this.registry[componentName]) {\n      console.warn(\n        `${componentName} already exists in registry. Will be overwriten.`\n      );\n    }\n    this.registry[componentName] = component;\n    return this;\n  }\n  get(componentName: string) {\n    return this.registry[componentName];\n  }\n}\n","import {\n  Injectable,\n  ComponentFactoryResolver,\n  ComponentFactory\n} from \"@angular/core\";\nimport { GComponentRegistryService } from \"./component-registry.service\";\n\n@Injectable({\n  providedIn: \"root\"\n})\nexport class GComponentFactoryService {\n  constructor(\n    private resolver: ComponentFactoryResolver,\n    private registry: GComponentRegistryService\n  ) {}\n\n  componentFactory(componentName: string): ComponentFactory<{}> {\n    const factory = this.resolver.resolveComponentFactory(\n      this.registry.get(componentName)\n    );\n    return factory;\n  }\n}\n","import { Type } from \"@angular/core\";\r\n\r\nexport class DropZoneState {\r\n  length: number;\r\n  items: { [key: string]: DropZoneItem };\r\n  constructor() {\r\n    this.length = 0;\r\n    this.items = {};\r\n  }\r\n}\r\n\r\nexport class DropZoneItem {\r\n  widgetId: string;\r\n  style: object;\r\n  componentName: string;\r\n}\r\n","import {\n  Component,\n  OnInit,\n  ViewChild,\n  ViewContainerRef,\n  Input,\n  ChangeDetectionStrategy,\n  OnChanges,\n  SimpleChanges,\n  Output,\n  EventEmitter\n} from \"@angular/core\";\nimport { GComponentFactoryService } from \"../../services/component-factory.service\";\nimport { IWidgetProjection } from \"../../interfaces/IWidgetProjection\";\nimport { takeWhile, first } from \"rxjs/operators\";\nimport { DropZoneState } from \"../../models/drop-zone.state\";\nimport { DropSuccessSyntheticEvent } from \"../../models/drop-success-synthetic-event\";\nimport { GComponentRegistryService } from \"../../services/component-registry.service\";\nimport { GInternalRegistryService } from \"../../services/internal-registry.service\";\nimport { ViewContainerItem } from \"../../models/view-container-item.model\";\n\n@Component({\n  selector: \"g-drop-zone\",\n  template: `\n    <div (dropsuccess)=\"dropsuccessHandler($event)\" gDroppable>\n      <template #dropContainer></template>\n    </div>\n  `,\n  styles: [\n    `\n      div {\n        width: 100%;\n        height: 100%;\n      }\n      div * {\n        pointer-events: none;\n      }\n    `\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DropZoneComponent implements OnInit, OnChanges {\n  @Input() state: DropZoneState;\n  @Output() update = new EventEmitter<DropZoneState>();\n  @ViewChild(\"dropContainer\", { read: ViewContainerRef })\n  container: ViewContainerRef;\n\n  constructor(\n    private gComponentFactoryService: GComponentFactoryService,\n    private internalRegistry: GInternalRegistryService\n  ) {}\n\n  ngOnInit() {}\n  ngOnChanges(changes: SimpleChanges) {\n    if (\"state\" in changes && changes[\"state\"].firstChange) {\n      for (const key in this.state.items) {\n        if (this.state.items.hasOwnProperty(key)) {\n          const dropZoneItem = this.state.items[key];\n          this.projectWidgetInView(\n            dropZoneItem.widgetId,\n            dropZoneItem.componentName,\n            dropZoneItem.style\n          );\n        }\n      }\n    }\n  }\n  dropsuccessHandler(syntheticEvent: DropSuccessSyntheticEvent) {\n    if (\n      this.internalRegistry.checkViewContainerItemEntry(syntheticEvent.widgetId)\n    ) {\n      return console.error(\"This widget is alrady pojected in view\");\n    }\n    this.projectWidgetInView(\n      syntheticEvent.widgetId,\n      syntheticEvent.componentName,\n      syntheticEvent.style\n    );\n    this.state.items[syntheticEvent.widgetId] = {\n      componentName: syntheticEvent.componentName,\n      style: syntheticEvent.style,\n      widgetId: syntheticEvent.widgetId\n    };\n    this.state.length += 1;\n    this.update.emit(this.state);\n  }\n  projectWidgetInView(\n    identifier: string,\n    componentName: string,\n    style: object\n  ) {\n    const factory = this.gComponentFactoryService.componentFactory(\n      componentName\n    );\n    const component = this.container.createComponent(factory);\n    const widgetProjection = component.instance as IWidgetProjection;\n    widgetProjection.widgetId = identifier;\n    widgetProjection.style = style;\n    widgetProjection._remove\n      .pipe(\n        takeWhile(_ => widgetProjection.isActive),\n        first()\n      )\n      .subscribe(widgetIdentifier => {\n        this.container.remove(\n          this.internalRegistry.getViewContainerItem(widgetIdentifier)\n            .viewContainerIndex\n        );\n        this.internalRegistry.removeViewContainerItem(widgetIdentifier);\n        delete this.state.items[widgetIdentifier];\n        this.state.length -= 1;\n        this.update.emit(this.state);\n      });\n    const computedStyle = getComputedStyle(\n      component.location.nativeElement.children[0]\n    );\n    this.internalRegistry.addViewContainerItem(identifier, {\n      viewContainerIndex: this.container.length - 1,\n      startX: +style[\"left.px\"],\n      startY: +style[\"top.px\"],\n      endX: +style[\"left.px\"] + +computedStyle.width.replace(/px/, \"\"),\n      endY: +style[\"top.px\"] + +computedStyle.height.replace(/px/, \"\")\n    });\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { DraggableDirective, DroppableDirective } from \"./directives\";\nimport { DropZoneComponent } from \"./components\";\nimport { GInternalRegistryService, GComponentFactoryService } from \"./services\";\n\n@NgModule({\n  declarations: [DraggableDirective, DroppableDirective, DropZoneComponent],\n  imports: [CommonModule],\n  providers: [GComponentFactoryService, GInternalRegistryService],\n  exports: [DraggableDirective, DroppableDirective, DropZoneComponent]\n})\nexport class DragyModule {}\n","import { Output, EventEmitter, Input, OnDestroy } from \"@angular/core\";\r\n\r\nexport class IWidgetProjection implements OnDestroy {\r\n  isActive = true;\r\n  @Input() widgetId: string;\r\n  @Input() style: object;\r\n  @Output() _remove = new EventEmitter<string>();\r\n  remove() {\r\n    this._remove.emit(this.widgetId);\r\n  }\r\n  ngOnDestroy(): void {\r\n    this.isActive = false;\r\n  }\r\n}\r\n","export class DragData {\r\n  widgetId: string;\r\n  offsetX: number;\r\n  offsetY: number;\r\n}\r\n","export class DropSuccessSyntheticEvent {\r\n  event: Event;\r\n  dragSourceSelector: string;\r\n  widgetId: string;\r\n  componentName: string;\r\n  style: object;\r\n}\r\n","export class ViewContainerItem {\r\n  viewContainerIndex: number;\r\n  startX: number;\r\n  endX: number;\r\n  startY: number;\r\n  endY: number;\r\n}\r\n"],"names":[],"mappings":"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"}
